<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrayTogether Admin Panel</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f3f4f6;
        }
        .container { max-width: 1280px; margin: 0 auto; padding: 0 1rem; }
        .bg-gradient { background: linear-gradient(135deg, #7c3aed 0%, #3b82f6 100%); }
        .bg-white { background: white; }
        .shadow { box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1); }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); }
        .shadow-xl { box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1); }
        .rounded { border-radius: 0.5rem; }
        .rounded-lg { border-radius: 0.75rem; }
        .rounded-xl { border-radius: 1rem; }
        .rounded-2xl { border-radius: 1.25rem; }
        .rounded-full { border-radius: 9999px; }
        .p-2 { padding: 0.5rem; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }
        .p-6 { padding: 1.5rem; }
        .p-8 { padding: 2rem; }
        .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
        .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .py-8 { padding-top: 2rem; padding-bottom: 2rem; }
        .mt-2 { margin-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .mt-6 { margin-top: 1.5rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .flex { display: flex; }
        .flex-1 { flex: 1 1 0%; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .space-x-2 > * + * { margin-left: 0.5rem; }
        .space-x-3 > * + * { margin-left: 0.75rem; }
        .space-x-4 > * + * { margin-left: 1rem; }
        .space-y-3 > * + * { margin-top: 0.75rem; }
        .space-y-6 > * + * { margin-top: 1.5rem; }
        .space-y-8 > * + * { margin-top: 2rem; }
        .grid { display: grid; }
        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .gap-6 { gap: 1.5rem; }
        .min-h-screen { min-height: 100vh; }
        .w-full { width: 100%; }
        .max-w-md { max-width: 28rem; }
        .max-w-7xl { max-width: 80rem; }
        .h-20 { height: 5rem; }
        .w-20 { height: 5rem; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .font-medium { font-weight: 500; }
        .font-semibold { font-weight: 600; }
        .font-bold { font-weight: 700; }
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .text-white { color: white; }
        .text-gray-600 { color: #4b5563; }
        .text-gray-700 { color: #374151; }
        .text-gray-800 { color: #1f2937; }
        .text-gray-900 { color: #111827; }
        .text-purple-600 { color: #9333ea; }
        .text-purple-700 { color: #7e22ce; }
        .text-red-700 { color: #b91c1c; }
        .text-blue-700 { color: #1d4ed8; }
        .text-green-700 { color: #15803d; }
        .text-yellow-700 { color: #a16207; }
        .bg-gray-50 { background-color: #f9fafb; }
        .bg-gray-100 { background-color: #f3f4f6; }
        .bg-purple-100 { background-color: #f3e8ff; }
        .bg-purple-600 { background-color: #9333ea; }
        .bg-red-100 { background-color: #fee2e2; }
        .bg-blue-100 { background-color: #dbeafe; }
        .bg-green-100 { background-color: #dcfce7; }
        .bg-yellow-100 { background-color: #fef3c7; }
        .border { border-width: 1px; }
        .border-b { border-bottom-width: 1px; }
        .border-l-4 { border-left-width: 4px; }
        .border-gray-300 { border-color: #d1d5db; }
        .uppercase { text-transform: uppercase; }
        .overflow-hidden { overflow: hidden; }
        .overflow-x-auto { overflow-x: auto; }
        .whitespace-nowrap { white-space: nowrap; }
        .cursor-pointer { cursor: pointer; }
        .transition { transition-property: all; transition-duration: 150ms; }
        button { border: none; cursor: pointer; outline: none; font-family: inherit; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        button:not(:disabled):hover { opacity: 0.9; }
        input { 
            border: 1px solid #d1d5db; 
            outline: none; 
            font-family: inherit;
            width: 100%;
        }
        input:focus { border-color: #9333ea; box-shadow: 0 0 0 3px rgba(147, 51, 234, 0.1); }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 1rem 1.5rem; text-align: left; }
        thead { background-color: #f9fafb; }
        tbody tr { border-bottom: 1px solid #e5e7eb; }
        tbody tr:hover { background-color: #f9fafb; }
        .tab { 
            padding: 1rem 0.5rem;
            border-bottom: 2px solid transparent;
            background: none;
            color: #4b5563;
            font-weight: 500;
            font-size: 0.875rem;
            transition: all 150ms;
        }
        .tab:hover { color: #9333ea; }
        .tab.active { border-bottom-color: #9333ea; color: #9333ea; }
        .stat-card { 
            background: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            border-left: 4px solid;
        }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        .progress-bar {
            height: 0.5rem;
            background: #e5e7eb;
            border-radius: 9999px;
            overflow: hidden;
            width: 6rem;
        }
        .progress-fill {
            height: 100%;
            background: #10b981;
            transition: width 300ms;
        }
        .icon { width: 1.5rem; height: 1.5rem; }
        .icon-sm { width: 1rem; height: 1rem; }
        @media (min-width: 768px) {
            .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }
        @media (min-width: 1024px) {
            .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }
            .lg\:px-8 { padding-left: 2rem; padding-right: 2rem; }
        }
        .hidden { display: none; }
        .animate-spin { animation: spin 1s linear infinite; }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        const API_BASE_URL = 'https://web-production-5cd1.up.railway.app/api';
        
        let state = {
            token: localStorage.getItem('admin_token') || '',
            isAuthenticated: false,
            activeTab: 'dashboard',
            loading: false,
            loginPhone: '05000000000',
            loginPassword: 'admin123456',
            stats: { totalUsers: 0, activePrayers: 0, completedPrayers: 0, totalPoints: 0 },
            users: [],
            prayers: []
        };

        function setState(newState) {
            state = { ...state, ...newState };
            render();
        }

        async function handleLogin() {
            setState({ loading: true });
            try {
                const response = await fetch(`${API_BASE_URL}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        name: 'Admin',
                        phone: state.loginPhone,
                        password: state.loginPassword
                    })
                });
                
                const data = await response.json();
                
                if (data.success && data.token) {
                    localStorage.setItem('admin_token', data.token);
                    setState({ token: data.token, isAuthenticated: true, loading: false });
                    fetchDashboardData();
                } else {
                    alert(data.message || 'Giriş başarısız');
                    setState({ loading: false });
                }
            } catch (error) {
                alert('Giriş hatası: ' + error.message);
                setState({ loading: false });
            }
        }

        function handleLogout() {
            localStorage.removeItem('admin_token');
            setState({ token: '', isAuthenticated: false });
        }

        async function fetchDashboardData() {
            setState({ loading: true });
            try {
                const mockUsers = [
                    { id: '1', name: 'Ahmet Yılmaz', phone: '05551234567', points: 850, prayers_completed: 45, created_at: '2025-01-15T10:30:00' },
                    { id: '2', name: 'Ayşe Demir', phone: '05559876543', points: 1200, prayers_completed: 67, created_at: '2025-01-10T08:20:00' },
                    { id: '3', name: 'Mehmet Kaya', phone: '05556547890', points: 450, prayers_completed: 23, created_at: '2025-02-01T14:15:00' },
                    { id: '4', name: 'Fatma Şahin', phone: '05553456789', points: 920, prayers_completed: 51, created_at: '2025-01-20T09:45:00' },
                    { id: '5', name: 'Ali Çelik', phone: '05558765432', points: 1500, prayers_completed: 89, created_at: '2025-01-05T11:30:00' }
                ];
                
                const mockPrayers = [
                    { id: '1', title: 'Hastalık için şifa duası', prayer_type: 'yasin', prayer_count: 7, prayer_completed_count: 5, status: 'active', requester_name: 'Ahmet Yılmaz', created_at: '2025-10-15T10:00:00' },
                    { id: '2', title: 'İmtihan başarısı için', prayer_type: 'fatiha', prayer_count: 10, prayer_completed_count: 10, status: 'completed', requester_name: 'Ayşe Demir', created_at: '2025-10-14T15:30:00' },
                    { id: '3', title: 'Aile huzuru için', prayer_type: 'ayetelkursi', prayer_count: 3, prayer_completed_count: 2, status: 'active', requester_name: 'Mehmet Kaya', created_at: '2025-10-16T08:20:00' },
                    { id: '4', title: 'İş bulma duası', prayer_type: 'ihlas', prayer_count: 33, prayer_completed_count: 28, status: 'active', requester_name: 'Fatma Şahin', created_at: '2025-10-15T12:45:00' },
                    { id: '5', title: 'Sıkıntıdan kurtuluş', prayer_type: 'felak', prayer_count: 5, prayer_completed_count: 5, status: 'completed', requester_name: 'Ali Çelik', created_at: '2025-10-13T09:15:00' }
                ];
                
                setState({
                    users: mockUsers,
                    prayers: mockPrayers,
                    stats: {
                        totalUsers: mockUsers.length,
                        activePrayers: mockPrayers.filter(p => p.status === 'active').length,
                        completedPrayers: mockPrayers.filter(p => p.status === 'completed').length,
                        totalPoints: mockUsers.reduce((sum, u) => sum + u.points, 0)
                    },
                    loading: false
                });
            } catch (error) {
                console.error('Data fetch error:', error);
                setState({ loading: false });
            }
        }

        function renderLogin() {
            return `
                <div class="min-h-screen bg-gradient flex items-center justify-center p-4">
                    <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md">
                        <div class="text-center mb-8">
                            <div class="bg-purple-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                                <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                                </svg>
                            </div>
                            <h1 class="text-3xl font-bold text-gray-800">PrayTogether</h1>
                            <p class="text-gray-600 mt-2">Admin Panel</p>
                        </div>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="text-sm font-medium text-gray-700 mb-2" style="display: block;">Telefon</label>
                                <input
                                    type="tel"
                                    id="loginPhone"
                                    value="${state.loginPhone}"
                                    class="px-4 py-3 rounded-lg"
                                    placeholder="05XXXXXXXXX"
                                />
                            </div>
                            
                            <div>
                                <label class="text-sm font-medium text-gray-700 mb-2" style="display: block;">Şifre</label>
                                <input
                                    type="password"
                                    id="loginPassword"
                                    value="${state.loginPassword}"
                                    class="px-4 py-3 rounded-lg"
                                    placeholder="••••••••"
                                />
                            </div>
                            
                            <button
                                onclick="handleLogin()"
                                ${state.loading ? 'disabled' : ''}
                                class="w-full bg-purple-600 text-white py-3 rounded-lg font-semibold transition"
                            >
                                ${state.loading ? 'Giriş yapılıyor...' : 'Giriş Yap'}
                            </button>
                        </div>
                        
                        <div class="mt-6 text-center text-sm text-gray-600">
                            <p>Varsayılan: 05000000000 / admin123456</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDashboard() {
            const { stats, prayers } = state;
            return `
                <div class="space-y-8">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="stat-card" style="border-left-color: #8b5cf6;">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-600 text-sm font-medium">Toplam Kullanıcı</p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2">${stats.totalUsers}</p>
                                </div>
                                <div class="p-3 rounded-full" style="background-color: rgba(139, 92, 246, 0.1);">
                                    <svg class="icon" style="color: #8b5cf6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card" style="border-left-color: #3b82f6;">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-600 text-sm font-medium">Aktif Dualar</p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2">${stats.activePrayers}</p>
                                </div>
                                <div class="p-3 rounded-full" style="background-color: rgba(59, 130, 246, 0.1);">
                                    <svg class="icon" style="color: #3b82f6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card" style="border-left-color: #10b981;">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-600 text-sm font-medium">Tamamlanan Dualar</p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2">${stats.completedPrayers}</p>
                                </div>
                                <div class="p-3 rounded-full" style="background-color: rgba(16, 185, 129, 0.1);">
                                    <svg class="icon" style="color: #10b981;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card" style="border-left-color: #f59e0b;">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-600 text-sm font-medium">Toplam Puan</p>
                                    <p class="text-3xl font-bold text-gray-800 mt-2">${stats.totalPoints.toLocaleString()}</p>
                                </div>
                                <div class="p-3 rounded-full" style="background-color: rgba(245, 158, 11, 0.1);">
                                    <svg class="icon" style="color: #f59e0b;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-xl shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Son Dua İstekleri</h3>
                        <div class="space-y-3">
                            ${prayers.slice(0, 5).map(prayer => `
                                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                    <div class="flex-1">
                                        <h4 class="font-semibold text-gray-800">${prayer.title}</h4>
                                        <p class="text-sm text-gray-600">${prayer.requester_name} • ${prayer.prayer_type}</p>
                                    </div>
                                    <div class="flex items-center space-x-4">
                                        <div class="text-right">
                                            <p class="text-sm font-medium text-gray-800">${prayer.prayer_completed_count}/${prayer.prayer_count}</p>
                                            <p class="text-xs text-gray-600">Tamamlanma</p>
                                        </div>
                                        <span class="badge ${prayer.status === 'completed' ? 'bg-green-100 text-green-700' : 'bg-blue-100 text-blue-700'}">
                                            ${prayer.status === 'completed' ? 'Tamamlandı' : 'Aktif'}
                                        </span>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderUsers() {
            return `
                <div class="bg-white rounded-xl shadow overflow-hidden">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-semibold text-gray-800">Kullanıcı Listesi</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table>
                            <thead>
                                <tr>
                                    <th class="text-xs font-medium text-gray-600 uppercase">İsim</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">Telefon</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">Puan</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">Tamamlanan</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">Kayıt Tarihi</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${state.users.map(user => `
                                    <tr>
                                        <td><div class="font-medium text-gray-900">${user.name}</div></td>
                                        <td class="text-gray-600">${user.phone}</td>
                                        <td><span class="badge bg-purple-100 text-purple-700">${user.points}</span></td>
                                        <td class="text-gray-600">${user.prayers_completed}</td>
                                        <td class="text-gray-600">${new Date(user.created_at).toLocaleDateString('tr-TR')}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderPrayers() {
            return `
                <div class="bg-white rounded-xl shadow overflow-hidden">
                    <div class="p-6 border-b">
                        <h3 class="text-lg font-semibold text-gray-800">Dua İstekleri</h3>
                    </div>
                    <div class="overflow-x-auto">
                        <table>
                            <thead>
                                <tr>
                                    <th class="text-xs font-medium text-gray-600 uppercase">Başlık</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">İsteyen</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">Tür</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">İlerleme</th>
                                    <th class="text-xs font-medium text-gray-600 uppercase">Durum</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${state.prayers.map(prayer => `
                                    <tr>
                                        <td><div class="font-medium text-gray-900">${prayer.title}</div></td>
                                        <td class="text-gray-600">${prayer.requester_name}</td>
                                        <td><span class="badge bg-blue-100 text-blue-700">${prayer.prayer_type}</span></td>
                                        <td>
                                            <div class="flex items-center space-x-2">
                                                <div class="progress-bar">
                                                    <div class="progress-fill" style="width: ${(prayer.prayer_completed_count / prayer.prayer_count) * 100}%;"></div>
                                                </div>
                                                <span class="text-sm text-gray-600">${prayer.prayer_completed_count}/${prayer.prayer_count}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="badge ${prayer.status === 'completed' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'}">
                                                ${prayer.status === 'completed' ? 'Tamamlandı' : 'Aktif'}
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderMain() {
            return `
                <div class="min-h-screen bg-gray-100">
                    <div class="bg-white shadow">
                        <div class="container">
                            <div class="flex justify-between items-center py-4">
                                <div class="flex items-center space-x-3">
                                    <div class="bg-purple-600 p-2 rounded-lg text-white">
                                        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                                        </svg>
                                    </div>
                                    <div>
                                        <h1 class="text-2xl font-bold text-gray-900">PrayTogether Admin</h1>
                                        <p class="text-sm text-gray-600">Yönetim Paneli</p>
                                    </div>
                                </div>
                                
                                <div class="flex items-center space-x-4">
                                    <button
                                        onclick="fetchDashboardData()"
                                        ${state.loading ? 'disabled' : ''}
                                        class="p-2 text-gray-600 transition"
                                        style="background: none;"
                                    >
                                        <svg class="icon ${state.loading ? 'animate-spin' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                        </svg>
                                    </button>
                                    <button
                                        onclick="handleLogout()"
                                        class="flex items-center space-x-2 px-4 py-2 bg-red-100 text-red-700 rounded-lg transition"
                                    >
                                        <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                                        </svg>
                                        <span>Çıkış</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white border-b">
                        <div class="container">
                            <div class="flex" style="gap: 2rem;">
                                <button onclick="setState({ activeTab: 'dashboard' })" class="tab ${state.activeTab === 'dashboard' ? 'active' : ''}">
                                    Dashboard
                                </button>
                                <button onclick="setState({ activeTab: 'users' })" class="tab ${state.activeTab === 'users' ? 'active' : ''}">
                                    Kullanıcılar
                                </button>
                                <button onclick="setState({ activeTab: 'prayers' })" class="tab ${state.activeTab === 'prayers' ? 'active' : ''}">
                                    Dua İstekleri
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="container py-8">
                        ${state.activeTab === 'dashboard' ? renderDashboard() : ''}
                        ${state.activeTab === 'users' ? renderUsers() : ''}
                        ${state.activeTab === 'prayers' ? renderPrayers() : ''}
                    </div>
                </div>
            `;
        }

        function render() {
            const app = document.getElementById('app');
            if (!state.isAuthenticated) {
                app.innerHTML = renderLogin();
                
                // Event listeners for login form
                const phoneInput = document.getElementById('loginPhone');
                const passwordInput = document.getElementById('loginPassword');
                if (phoneInput) {
                    phoneInput.addEventListener('input', (e) => {
                        state.loginPhone = e.target.value;
                    });
                }
                if (passwordInput) {
                    passwordInput.addEventListener('input', (e) => {
                        state.loginPassword = e.target.value;
                    });
                    passwordInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') handleLogin();
                    });
                }
            } else {
                app.innerHTML = renderMain();
            }
        }

        // Initial render
        if (state.token) {
            state.isAuthenticated = true;
            fetchDashboardData();
        } else {
            render();
        }
    </script>
</body>
</html>